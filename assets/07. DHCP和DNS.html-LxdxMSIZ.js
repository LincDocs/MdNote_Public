import{_ as l,c as p,e as o,a as s,b as e,d as t,o as i,r as c}from"./app-Dt9PEj-q.js";const d={},r={href:"https://tonydeng.github.io/sdn-handbook/basic/tcp.html",target:"_blank",rel:"noopener noreferrer"},u={href:"http://www.thekelleys.org.uk/dnsmasq/CHANGELOG",target:"_blank",rel:"noopener noreferrer"},m={href:"https://tools.ietf.org/html/rfc1123",target:"_blank",rel:"noopener noreferrer"},k={href:"https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol",target:"_blank",rel:"noopener noreferrer"};function b(v,n){const a=c("ExternalLinkIcon");return i(),p("div",null,[n[20]||(n[20]=o('<h1 id="dhcp和dns" tabindex="-1"><a class="header-anchor" href="#dhcp和dns"><span>DHCP和DNS</span></a></h1><h2 id="dhcp" tabindex="-1"><a class="header-anchor" href="#dhcp"><span>DHCP</span></a></h2><p><code>DHCP</code>（<code>Dynamic Host Configuration Protocol</code>）是一个用于主机动态获取<code>IP</code>地址的配置解析，使用<code>UDP</code>报文传送，端口号为<code>67</code>(server)和<code>68</code>(client)。</p><p><code>DHCP</code>使用了租约的概念，或称为计算机<code>IP</code>地址的有效期。租用时间是不定的，主要取决于用户在某地连接<code>Internet</code>需要多久，这对于教育行业和其它用户频繁改变的环境是很实用的。通过较短的租期，<code>DHCP</code>能够在一个计算机比可用IP地址多的环境中动态地重新配置网络。<code>DHCP</code>支持为计算机分配静态地址，如需要永久性IP地址的Web服务器。</p><p>![dhcp session](07. DHCP和DNS.assets/DHCP_session_en.svg)</p><h2 id="dns" tabindex="-1"><a class="header-anchor" href="#dns"><span>DNS</span></a></h2><h3 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍"><span>介绍</span></a></h3><p><code>DNS</code>（<code>Domain Name System</code>）是一个解析域名和IP地址对应关系以及电子邮件选路信息的服务。它以递归的方式运行：首先访问最近的DNS服务器，如果查询到域名对应的IP地址则直接返回，否则的话再向上一级查询。<code>DNS</code>通常以<code>UDP</code>报文来传送，并使用端口号<code>53</code>。</p><p>从应用的角度来看，其实就是两个库函数<code>gethostbyname()</code>和<code>gethostbyaddr()</code>。</p><blockquote><p><code>FQDN</code>：全域名(<code>FQDN</code>，<code>Fully Qualified Domain Name</code>)是指主机名加上全路径，全路径中列出了序列中所有域成员(包括<code>root</code>)。全域名可以从逻辑上准确地表示出主机在什么地方，也可以说全域名是主机名的一种完全表示形式。</p></blockquote><h4 id="资源记录-rr" tabindex="-1"><a class="header-anchor" href="#资源记录-rr"><span>资源记录（RR）</span></a></h4><ul><li><strong>A记录</strong>：用于查询IP地址</li><li><strong>PTR记录</strong>：逆向查询记录，用于从IP地址查询域名</li><li><strong>CNAME</strong>：表示“规范名字”，用来表示一个域名，也通常称为别名</li><li><strong>HINFO</strong>：表示主机信息，包括主机 CPU 和操作系统的两个字符串</li><li><strong>MX</strong>：邮件交换记录</li><li><strong>NS</strong>：名字服务器记录，即下一级域名信息的服务器地址，只能设置为域名，不能是 IP</li></ul><h4 id="高速缓存" tabindex="-1"><a class="header-anchor" href="#高速缓存"><span>高速缓存</span></a></h4><p>为了减少 DNS 的通信量，所有的名字服务器均使用高速缓存。在标准 Unix 是实现中，高速缓存是由名字服务器而不是名字解释器来维护的。</p><h4 id="用udp还是tcp" tabindex="-1"><a class="header-anchor" href="#用udp还是tcp"><span>用UDP还是TCP</span></a></h4><p><code>DNS</code>服务器支持<code>TCP</code>和<code>UDP</code>两种协议的查询方式，而且端口都是<code>53</code>。而大多数的查询都是<code>UDP</code>查询的，一般需要<code>TCP</code>查询的有两种情况：</p>',16)),s("ol",null,[s("li",null,[n[2]||(n[2]=e("当查询数据多大以至于产生了数据截断(")),n[3]||(n[3]=s("code",null,"TC标志为1",-1)),n[4]||(n[4]=e(")，这时，需要利用")),n[5]||(n[5]=s("code",null,"TCP",-1)),n[6]||(n[6]=e("的分片能力来进行数据传输（看")),s("a",r,[n[0]||(n[0]=s("code",null,"TCP",-1)),n[1]||(n[1]=e("的相关章节")),t(a)]),n[7]||(n[7]=e("）。"))]),n[8]||(n[8]=s("li",null,[e("当主（"),s("code",null,"master"),e("）服务器和辅（"),s("code",null,"slave"),e("）服务器之间通信，辅服务器要拿到主服务器的"),s("code",null,"zone"),e("信息的时候。")],-1))]),n[21]||(n[21]=o(`<h3 id="示例" tabindex="-1"><a class="header-anchor" href="#示例"><span>示例</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ <span class="token function">dig</span> k8s.io
<span class="token punctuation">;</span> <span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span> DiG <span class="token number">9.10</span>.3-P4-Ubuntu <span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span> k8s.io
<span class="token punctuation">;</span><span class="token punctuation">;</span> global options: +cmd
<span class="token punctuation">;</span><span class="token punctuation">;</span> Got answer:
<span class="token punctuation">;</span><span class="token punctuation">;</span> -<span class="token operator">&gt;&gt;</span>HEADER<span class="token operator">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class="token number">37946</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> flags: qr rd ra<span class="token punctuation">;</span> QUERY: <span class="token number">1</span>, ANSWER: <span class="token number">1</span>, AUTHORITY: <span class="token number">0</span>, ADDITIONAL: <span class="token number">1</span>

<span class="token punctuation">;</span><span class="token punctuation">;</span> OPT PSEUDOSECTION:
<span class="token punctuation">;</span> EDNS: version: <span class="token number">0</span>, flags:<span class="token punctuation">;</span> udp: <span class="token number">512</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> QUESTION SECTION:
<span class="token punctuation">;</span>k8s.io.                IN    A

<span class="token punctuation">;</span><span class="token punctuation">;</span> ANSWER SECTION:
k8s.io.            <span class="token number">299</span>    IN    A    <span class="token number">23.236</span>.58.218

<span class="token punctuation">;</span><span class="token punctuation">;</span> Query time: <span class="token number">392</span> msec
<span class="token punctuation">;</span><span class="token punctuation">;</span> SERVER: <span class="token number">169.254</span>.169.254<span class="token comment">#53(169.254.169.254)</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> WHEN: Mon Sep <span class="token number">11</span> 05:50:37 UTC <span class="token number">2017</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> MSG SIZE  rcvd: <span class="token number">51</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="反向查询" tabindex="-1"><a class="header-anchor" href="#反向查询"><span>反向查询</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ <span class="token function">dig</span> <span class="token parameter variable">-x</span> <span class="token number">23.236</span>.58.218
<span class="token punctuation">;</span> <span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span> DiG <span class="token number">9.10</span>.3-P4-Ubuntu <span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span> <span class="token parameter variable">-x</span> <span class="token number">23.236</span>.58.218
<span class="token punctuation">;</span><span class="token punctuation">;</span> global options: +cmd
<span class="token punctuation">;</span><span class="token punctuation">;</span> Got answer:
<span class="token punctuation">;</span><span class="token punctuation">;</span> -<span class="token operator">&gt;&gt;</span>HEADER<span class="token operator">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class="token number">7130</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> flags: qr rd ra<span class="token punctuation">;</span> QUERY: <span class="token number">1</span>, ANSWER: <span class="token number">1</span>, AUTHORITY: <span class="token number">0</span>, ADDITIONAL: <span class="token number">1</span>

<span class="token punctuation">;</span><span class="token punctuation">;</span> OPT PSEUDOSECTION:
<span class="token punctuation">;</span> EDNS: version: <span class="token number">0</span>, flags:<span class="token punctuation">;</span> udp: <span class="token number">512</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> QUESTION SECTION:
<span class="token punctuation">;</span><span class="token number">218.58</span>.236.23.in-addr.arpa.    IN    PTR

<span class="token punctuation">;</span><span class="token punctuation">;</span> ANSWER SECTION:
<span class="token number">218.58</span>.236.23.in-addr.arpa. <span class="token number">119</span>    IN    PTR    <span class="token number">218.58</span>.236.23.bc.googleusercontent.com.

<span class="token punctuation">;</span><span class="token punctuation">;</span> Query time: <span class="token number">158</span> msec
<span class="token punctuation">;</span><span class="token punctuation">;</span> SERVER: <span class="token number">169.254</span>.169.254<span class="token comment">#53(169.254.169.254)</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> WHEN: Mon Sep <span class="token number">11</span> 05:50:45 UTC <span class="token number">2017</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> MSG SIZE  rcvd: <span class="token number">107</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="faq" tabindex="-1"><a class="header-anchor" href="#faq"><span>FAQ</span></a></h2><h3 id="dnsmasq-bad-dhcp-host-name-问题" tabindex="-1"><a class="header-anchor" href="#dnsmasq-bad-dhcp-host-name-问题"><span>dnsmasq bad DHCP host name 问题</span></a></h3>`,6)),s("p",null,[n[10]||(n[10]=e("这个问题是由于")),n[11]||(n[11]=s("code",null,"hostname",-1)),n[12]||(n[12]=e("是数字前缀，并且")),n[13]||(n[13]=s("code",null,"dnsmasq",-1)),n[14]||(n[14]=e("对版本低于2.67，这个问题在")),s("a",u,[n[9]||(n[9]=e("2.67版本中修复")),t(a)]),n[15]||(n[15]=e(":"))]),s("blockquote",null,[s("p",null,[n[17]||(n[17]=e("Allow hostnames to start with a number, as allowed in ")),s("a",m,[n[16]||(n[16]=e("RFC-1123")),t(a)]),n[18]||(n[18]=e(". Thanks to Kyle Mestery for the patch."))])]),n[22]||(n[22]=s("h2",{id:"参考",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#参考"},[s("span",null,"参考")])],-1)),s("ul",null,[s("li",null,[s("a",k,[n[19]||(n[19]=e("Dynamic Host Configuration Protocol")),t(a)])])])])}const h=l(d,[["render",b],["__file","07. DHCP和DNS.html.vue"]]),E=JSON.parse('{"path":"/01.%20DesignAndDevelop/Develop/02.%20Theory/Computer/03.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%20-%20%E4%B8%93%E9%A2%98%E6%88%96%E5%AD%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AD%97%E5%85%B8%E7%89%88/%E4%B8%8B%E5%B1%82%E7%9B%B8%E5%85%B3/Network/%E3%80%8Asdn-handbook%E3%80%8Btonydeng/02.%20%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA/07.%20DHCP%E5%92%8CDNS.html","title":"DHCP和DNS","lang":"zh-CN","frontmatter":{"description":"DHCP和DNS DHCP DHCP（Dynamic Host Configuration Protocol）是一个用于主机动态获取IP地址的配置解析，使用UDP报文传送，端口号为67(server)和68(client)。 DHCP使用了租约的概念，或称为计算机IP地址的有效期。租用时间是不定的，主要取决于用户在某地连接Internet需要多久，这对...","head":[["meta",{"property":"og:url","content":"https://LincDocs.github.io/MdNote_Public/01.%20DesignAndDevelop/Develop/02.%20Theory/Computer/03.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%20-%20%E4%B8%93%E9%A2%98%E6%88%96%E5%AD%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AD%97%E5%85%B8%E7%89%88/%E4%B8%8B%E5%B1%82%E7%9B%B8%E5%85%B3/Network/%E3%80%8Asdn-handbook%E3%80%8Btonydeng/02.%20%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA/07.%20DHCP%E5%92%8CDNS.html"}],["meta",{"property":"og:site_name","content":"MdNote_Public"}],["meta",{"property":"og:title","content":"DHCP和DNS"}],["meta",{"property":"og:description","content":"DHCP和DNS DHCP DHCP（Dynamic Host Configuration Protocol）是一个用于主机动态获取IP地址的配置解析，使用UDP报文传送，端口号为67(server)和68(client)。 DHCP使用了租约的概念，或称为计算机IP地址的有效期。租用时间是不定的，主要取决于用户在某地连接Internet需要多久，这对..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-19T07:08:37.000Z"}],["meta",{"property":"article:author","content":"LincDocs"}],["meta",{"property":"article:modified_time","content":"2025-01-19T07:08:37.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"DHCP和DNS\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-19T07:08:37.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincDocs\\",\\"url\\":\\"https://github.com/LincDocs/MdNote_Public/\\"}]}"]]},"headers":[{"level":1,"title":"DHCP和DNS","slug":"dhcp和dns","link":"#dhcp和dns","children":[{"level":2,"title":"DHCP","slug":"dhcp","link":"#dhcp","children":[]},{"level":2,"title":"DNS","slug":"dns","link":"#dns","children":[{"level":3,"title":"介绍","slug":"介绍","link":"#介绍","children":[{"level":4,"title":"资源记录（RR）","slug":"资源记录-rr","link":"#资源记录-rr","children":[]},{"level":4,"title":"高速缓存","slug":"高速缓存","link":"#高速缓存","children":[]},{"level":4,"title":"用UDP还是TCP","slug":"用udp还是tcp","link":"#用udp还是tcp","children":[]}]},{"level":3,"title":"示例","slug":"示例","link":"#示例","children":[{"level":4,"title":"反向查询","slug":"反向查询","link":"#反向查询","children":[]}]}]},{"level":2,"title":"FAQ","slug":"faq","link":"#faq","children":[{"level":3,"title":"dnsmasq bad DHCP host name 问题","slug":"dnsmasq-bad-dhcp-host-name-问题","link":"#dnsmasq-bad-dhcp-host-name-问题","children":[]}]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}]}],"git":{"createdTime":1737270517000,"updatedTime":1737270517000,"contributors":[{"name":"Linc","email":"762699299@qq.com","commits":1}]},"readingTime":{"minutes":3.11,"words":934},"filePathRelative":"01. DesignAndDevelop/Develop/02. Theory/Computer/03. 计算机系统 - 专题或子系统的字典版/下层相关/Network/《sdn-handbook》tonydeng/02. 网络基础理论/07. DHCP和DNS.md","localizedDate":"2025年1月19日","excerpt":"\\n<h2>DHCP</h2>\\n<p><code>DHCP</code>（<code>Dynamic Host Configuration Protocol</code>）是一个用于主机动态获取<code>IP</code>地址的配置解析，使用<code>UDP</code>报文传送，端口号为<code>67</code>(server)和<code>68</code>(client)。</p>\\n<p><code>DHCP</code>使用了租约的概念，或称为计算机<code>IP</code>地址的有效期。租用时间是不定的，主要取决于用户在某地连接<code>Internet</code>需要多久，这对于教育行业和其它用户频繁改变的环境是很实用的。通过较短的租期，<code>DHCP</code>能够在一个计算机比可用IP地址多的环境中动态地重新配置网络。<code>DHCP</code>支持为计算机分配静态地址，如需要永久性IP地址的Web服务器。</p>","autoDesc":true,"bioChainData":{"outlink":[],"backlink":[],"localMap":{"nodes":[{"id":"01. DesignAndDevelop/Develop/02. Theory/Computer/03. 计算机系统 - 专题或子系统的字典版/下层相关/Network/《sdn-handbook》tonydeng/02. 网络基础理论/07. DHCP和DNS.md","value":{"title":"07. DHCP和DNS","path":"01. DesignAndDevelop/Develop/02. Theory/Computer/03. 计算机系统 - 专题或子系统的字典版/下层相关/Network/《sdn-handbook》tonydeng/02. 网络基础理论/07. DHCP和DNS.md","outlink":[],"backlink":[]}}],"links":[]}}}');export{h as comp,E as data};
