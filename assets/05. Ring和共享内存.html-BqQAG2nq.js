import{_ as i,c as s,f as n,o as t}from"./app-Bf82mvyV.js";const a={};function l(r,e){return t(),s("div",null,e[0]||(e[0]=[n(`<h1 id="dpdk-ring-and-ivshmem" tabindex="-1"><a class="header-anchor" href="#dpdk-ring-and-ivshmem"><span>DPDK Ring and ivshmem</span></a></h1><h2 id="dpdk-ring" tabindex="-1"><a class="header-anchor" href="#dpdk-ring"><span>DPDK Ring</span></a></h2><p><code>DPDK Ring</code>提供了一个<code>FIFO</code>无锁队列，支持丰富的队列操作，比如</p><ul><li>Multi-consumer or single-consumer dequeue</li><li>Multi-producer or single-producer enqueue</li><li>Bulk dequeue - Dequeues the specified count of objects if successful; otherwise fails</li><li>Bulk enqueue - Enqueues the specified count of objects if successful; otherwise fails</li><li>Burst dequeue - Dequeue the maximum available objects if the specified count cannot be fulfilled</li><li>Burst enqueue - Enqueue the maximum available objects if the specified count cannot be fulfilled</li></ul><p>![dpdk ring enqueue](05. Ring和共享内存.assets/ring-structure.svg)</p><blockquote><p>图片来源<a href="http://dpdk.org/doc/guides/prog_guide/ring_lib.html" target="_blank" rel="noopener noreferrer">Ring Library - dpdk.org</a></p></blockquote><h2 id="ivshmem" tabindex="-1"><a class="header-anchor" href="#ivshmem"><span>ivshmem</span></a></h2><p><code>ivshmem</code>则通过把内存映射成虚拟机PCI设备提供了虚拟机间(<code>host-to-guest or guest-to-guest</code>)共享内存的机制。</p><p>![Typical ivshmem use case](05. Ring和共享内存.assets/typical-ivshmem-use-case.png)</p><blockquote><p>图片来源<a href="http://dpdk.org/doc/guides-16.04/prog_guide/ivshmem_lib.html" target="_blank" rel="noopener noreferrer">DPDK IVSHMEM Library</a></p></blockquote><p>DPDK <code>ivshmem</code>:</p><p>![DPDK nics](05. Ring和共享内存.assets/dpdk-nics.jpeg)</p><blockquote><p>图片来源<a href="http://blog.csdn.net/quqi99/article/details/51087955" target="_blank" rel="noopener noreferrer">使用OVS DPDK (by quqi99)</a></p></blockquote><h3 id="ivshmem使用示例" tabindex="-1"><a class="header-anchor" href="#ivshmem使用示例"><span>ivshmem使用示例</span></a></h3><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># on the host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/shm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -osize=32m</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ivshmem_server</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 64</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p/tmp/nahanni</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># start VM</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">qemu-system-x86_64</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -hda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mg</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /pc-bios/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --smp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> –chardev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> socket,path=/tmp/nahanni,id=nahanni-device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ivshmem,chardev=nahanni,size=32m,msi=off</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -serial</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> telnet:0.0.0.0:4000,server,nowait,nodelay-enable-kvm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># inside VM</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">modprobe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kvm_ivshmem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat/proc/devices</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kvm_ivshmem</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">mknod-mode</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">666</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /dev/ivshmem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 245</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>参考文档</strong></p><ul><li><a href="http://dpdk.org/doc/guides/prog_guide/ring_lib.html" target="_blank" rel="noopener noreferrer">DPDK Ring Library</a></li><li><a href="http://dpdk.org/doc/guides-16.04/prog_guide/ivshmem_lib.html" target="_blank" rel="noopener noreferrer">DPDK IVSHMEM Library</a></li><li><a href="http://slideplayer.com/slide/4900352/" target="_blank" rel="noopener noreferrer">Accelerating the Path to the Guest</a></li><li><a href="https://www.slideshare.net/jstleger/7-dpdk-summit-2014-v-mwareintel-virtualization" target="_blank" rel="noopener noreferrer">DPDK Summit - 08 Sept 2014 - VMware and Intel - Using DPDK In A Virtual World</a></li></ul>`,17)]))}const d=i(a,[["render",l],["__file","05. Ring和共享内存.html.vue"]]),o=JSON.parse('{"path":"/01.%20DesignAndDevelop/Develop/02.%20Theory/Computer/03.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%20-%20%E4%B8%93%E9%A2%98%E6%88%96%E5%AD%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AD%97%E5%85%B8%E7%89%88/%E4%B8%8B%E5%B1%82%E7%9B%B8%E5%85%B3/Network/%E3%80%8Asdn-handbook%E3%80%8Btonydeng/05.%20DPDK/05.%20Ring%E5%92%8C%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98.html","title":"DPDK Ring and ivshmem","lang":"zh-CN","frontmatter":{"description":"DPDK Ring and ivshmem DPDK Ring DPDK Ring提供了一个FIFO无锁队列，支持丰富的队列操作，比如 Multi-consumer or single-consumer dequeue Multi-producer or single-producer enqueue Bulk dequeue - Dequeues t...","head":[["meta",{"property":"og:url","content":"https://LincDocs.github.io/MdNote_Public/01.%20DesignAndDevelop/Develop/02.%20Theory/Computer/03.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%20-%20%E4%B8%93%E9%A2%98%E6%88%96%E5%AD%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AD%97%E5%85%B8%E7%89%88/%E4%B8%8B%E5%B1%82%E7%9B%B8%E5%85%B3/Network/%E3%80%8Asdn-handbook%E3%80%8Btonydeng/05.%20DPDK/05.%20Ring%E5%92%8C%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98.html"}],["meta",{"property":"og:site_name","content":"MdNote_Public"}],["meta",{"property":"og:title","content":"DPDK Ring and ivshmem"}],["meta",{"property":"og:description","content":"DPDK Ring and ivshmem DPDK Ring DPDK Ring提供了一个FIFO无锁队列，支持丰富的队列操作，比如 Multi-consumer or single-consumer dequeue Multi-producer or single-producer enqueue Bulk dequeue - Dequeues t..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-02-03T15:36:56.000Z"}],["meta",{"property":"article:modified_time","content":"2025-02-03T15:36:56.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"DPDK Ring and ivshmem\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-02-03T15:36:56.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincDocs\\",\\"url\\":\\"https://github.com/LincDocs/MdNote_Public/\\"}]}"]]},"headers":[{"level":1,"title":"DPDK Ring and ivshmem","slug":"dpdk-ring-and-ivshmem","link":"#dpdk-ring-and-ivshmem","children":[{"level":2,"title":"DPDK Ring","slug":"dpdk-ring","link":"#dpdk-ring","children":[]},{"level":2,"title":"ivshmem","slug":"ivshmem","link":"#ivshmem","children":[{"level":3,"title":"ivshmem使用示例","slug":"ivshmem使用示例","link":"#ivshmem使用示例","children":[]}]}]}],"git":{"createdTime":1738597016000,"updatedTime":1738597016000,"contributors":[{"name":"Linc","username":"Linc","email":"762699299@qq.com","commits":1,"url":"https://github.com/Linc"}]},"readingTime":{"minutes":1.05,"words":316},"filePathRelative":"01. DesignAndDevelop/Develop/02. Theory/Computer/03. 计算机系统 - 专题或子系统的字典版/下层相关/Network/《sdn-handbook》tonydeng/05. DPDK/05. Ring和共享内存.md","localizedDate":"2025年2月3日","excerpt":"\\n<h2>DPDK Ring</h2>\\n<p><code>DPDK Ring</code>提供了一个<code>FIFO</code>无锁队列，支持丰富的队列操作，比如</p>\\n<ul>\\n<li>Multi-consumer or single-consumer dequeue</li>\\n<li>Multi-producer or single-producer enqueue</li>\\n<li>Bulk dequeue - Dequeues the specified count of objects if successful; otherwise fails</li>\\n<li>Bulk enqueue - Enqueues the specified count of objects if successful; otherwise fails</li>\\n<li>Burst dequeue - Dequeue the maximum available objects if the specified count cannot be fulfilled</li>\\n<li>Burst enqueue - Enqueue the maximum available objects if the specified count cannot be fulfilled</li>\\n</ul>","autoDesc":true,"bioChainData":{"outlink":[],"backlink":[],"localMap":{"nodes":[{"id":"01. DesignAndDevelop/Develop/02. Theory/Computer/03. 计算机系统 - 专题或子系统的字典版/下层相关/Network/《sdn-handbook》tonydeng/05. DPDK/05. Ring和共享内存.md","value":{"title":"05. Ring和共享内存","path":"01. DesignAndDevelop/Develop/02. Theory/Computer/03. 计算机系统 - 专题或子系统的字典版/下层相关/Network/《sdn-handbook》tonydeng/05. DPDK/05. Ring和共享内存.md","outlink":[],"backlink":[]}}],"links":[]}}}');export{d as comp,o as data};
