import{_ as s,c as a,e as t,o as p}from"./app-Dt9PEj-q.js";const e={};function o(c,n){return p(),a("div",null,n[0]||(n[0]=[t(`<h1 id="其他" tabindex="-1"><a class="header-anchor" href="#其他"><span>其他</span></a></h1><h2 id="官方示例" tabindex="-1"><a class="header-anchor" href="#官方示例"><span>官方示例</span></a></h2><h3 id="obsidian-sample-plugin" tabindex="-1"><a class="header-anchor" href="#obsidian-sample-plugin"><span>Obsidian-sample-plugin</span></a></h3><p>https://github.com/obsidianmd/obsidian-sample-plugin</p><h4 id="使用" tabindex="-1"><a class="header-anchor" href="#使用"><span>使用</span></a></h4><blockquote><h5 id="编译方法" tabindex="-1"><a class="header-anchor" href="#编译方法"><span>编译方法</span></a></h5></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 首先要先安装nodejs，里面包含npm工具</span>
<span class="token function">npm</span> i             <span class="token comment"># 等同于npm install</span>
<span class="token function">npm</span> run dev       <span class="token comment"># 进行编译，将ts编译成js</span>

<span class="token comment"># 如果Obsidian API更新了</span>
<span class="token function">npm</span> update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h5 id="手动安装插件" tabindex="-1"><a class="header-anchor" href="#手动安装插件"><span>手动安装插件</span></a></h5></blockquote><p>复制 <code>main.js, styles.css, manifest. js</code> 到Ob的插件路径</p><blockquote><h5 id="功能" tabindex="-1"><a class="header-anchor" href="#功能"><span>功能</span></a></h5></blockquote><ul><li>有设置菜单</li><li>有小图标，小图标可以输出tips</li><li>输出文字 “Sample Editor Command”</li><li>打开提示窗</li></ul><blockquote><h5 id="发布新版本" tabindex="-1"><a class="header-anchor" href="#发布新版本"><span>发布新版本</span></a></h5></blockquote><ul><li><p>json加上你的版本号，以及最新版本所需的最低Obsidian版本</p></li><li><p>更新你的版本</p></li><li><p>上传清单：Json，main.js，styles.css。<br> 注意: Json文件必须在两个地方，第一个是存储库的根路径，另一个是发布版本</p></li><li><p>你可以在手动更新 manifest.json 中的 minAppVersion 运行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> version patch
<span class="token comment"># 或</span>
<span class="token function">npm</span> version minor
<span class="token comment"># 或</span>
<span class="token function">npm</span> version major
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>来来简化版本碰撞过程</p></li></ul><blockquote><h5 id="将您的插件添加到社区插件列表中" tabindex="-1"><a class="header-anchor" href="#将您的插件添加到社区插件列表中"><span>将您的插件添加到社区插件列表中</span></a></h5></blockquote><p>略</p><blockquote><h5 id="使用eslint提高代码质量-可选" tabindex="-1"><a class="header-anchor" href="#使用eslint提高代码质量-可选"><span>使用eslint提高代码质量(可选)</span></a></h5></blockquote><p>略</p><h4 id="代码" tabindex="-1"><a class="header-anchor" href="#代码"><span>代码</span></a></h4><p>main.ts（注释汉化版本）</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Editor<span class="token punctuation">,</span> MarkdownView<span class="token punctuation">,</span> Modal<span class="token punctuation">,</span> Notice<span class="token punctuation">,</span> Plugin<span class="token punctuation">,</span> PluginSettingTab<span class="token punctuation">,</span> Setting <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;obsidian&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 记得重命名这些类和接口!</span>

<span class="token keyword">interface</span> <span class="token class-name">MyPluginSettings</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token operator">:</span> MyPluginSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token string">&#39;default&#39;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
	settings<span class="token operator">:</span> MyPluginSettings<span class="token punctuation">;</span>

	<span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将在左侧色带中创建一个图标</span>
		<span class="token keyword">const</span> ribbonIconEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&#39;dice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Sample Plugin&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// 当用户单击图标时调用：发送一条信息</span>
			<span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token string">&#39;This is a notice!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 对色带执行额外的操作</span>
		ribbonIconEl<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;my-plugin-ribbon-class&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将添加一个状态栏项目的底部的应用程序。不工作在移动应用程序</span>
		<span class="token keyword">const</span> statusBarItemEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addStatusBarItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		statusBarItemEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Status Bar Text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这增加了一个可以在任何地方触发的简单命令</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-simple&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (simple)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 这将添加一个编辑器命令，可以对当前编辑器实例执行某些操作</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;sample-editor-command&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Sample editor command&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				editor<span class="token punctuation">.</span><span class="token function">replaceSelection</span><span class="token punctuation">(</span><span class="token string">&#39;Sample Editor Command&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 这添加了一个复杂的命令,可以检查应用程序的当前状态是否允许执行命令</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-complex&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (complex)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">checkCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>checking<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token comment">// 条件检查</span>
				<span class="token keyword">const</span> markdownView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>markdownView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 如果检查为真，我们只是在“检查”命令是否可以运行</span>
					<span class="token comment">// 如果检查为false，那么我们想实际执行操作</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>checking<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token comment">// 只有当check函数返回true时，该命令才会显示在命令面板中</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将添加一个设置选项卡，以便用户可以配置插件的各个方面</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addSettingTab</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SampleSettingTab</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 如果该插件连接了任何全局DOM事件(在不属于该插件的应用程序部分上)</span>
		<span class="token comment">//当这个插件被禁用时，使用这个函数会自动删除事件监听器。</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerDomEvent</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 当注册间隔时，当插件被禁用时，该函数将自动清除间隔</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerInterval</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;setInterval&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onunload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token keyword">async</span> <span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>settings <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token punctuation">,</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">async</span> <span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SampleModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Woah!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SampleSettingTab</span> <span class="token keyword">extends</span> <span class="token class-name">PluginSettingTab</span> <span class="token punctuation">{</span>
	plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">,</span> plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>plugin <span class="token operator">=</span> plugin<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>containerEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

		containerEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		containerEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&#39;h2&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>text<span class="token operator">:</span> <span class="token string">&#39;Settings for my awesome plugin.&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>containerEl<span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&#39;Setting #1&#39;</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">setDesc</span><span class="token punctuation">(</span><span class="token string">&#39;It\\&#39;s a secret&#39;</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span>text <span class="token operator">=&gt;</span> text
				<span class="token punctuation">.</span><span class="token function">setPlaceholder</span><span class="token punctuation">(</span><span class="token string">&#39;Enter your secret&#39;</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Secret: &#39;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting <span class="token operator">=</span> value<span class="token punctuation">;</span>
					<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span><span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="api接口" tabindex="-1"><a class="header-anchor" href="#api接口"><span>API接口</span></a></h3><p>https://github.com/obsidianmd/obsidian-api</p><p>也可以看开发文档中，接口类自动生成的文档（但是没有多什么注释，感觉和直接看api文件也差不多）： https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/AbstractTextComponent.html</p><p>obsidian.d.ts</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// 4406行</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="插入链接示例-开发文档示例" tabindex="-1"><a class="header-anchor" href="#插入链接示例-开发文档示例"><span>插入链接示例（开发文档示例）</span></a></h3><p>https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/examples/insert-link.html</p><p>main.ts</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Editor<span class="token punctuation">,</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> InsertLinkModal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./modal&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">InsertLinkPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">&quot;insert-link&quot;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&quot;Insert link&quot;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> selectedText <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> <span class="token function-variable function">onSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          editor<span class="token punctuation">.</span><span class="token function">replaceSelection</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">](</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">InsertLinkModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">,</span> selectedText<span class="token punctuation">,</span> onSubmit<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>./modal.ts</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Modal<span class="token punctuation">,</span> Setting <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">InsertLinkModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
  linkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  linkUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span>linkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> linkUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    app<span class="token operator">:</span> App<span class="token punctuation">,</span>
    defaultLinkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span>linkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> linkUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>linkText <span class="token operator">=</span> defaultLinkText<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit <span class="token operator">=</span> onSubmit<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    contentEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;h1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;Insert link&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Link text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      text<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>linkText<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>linkText <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Link URL&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      text<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>linkUrl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>linkUrl <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addButton</span><span class="token punctuation">(</span><span class="token punctuation">(</span>btn<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      btn
        <span class="token punctuation">.</span><span class="token function">setButtonText</span><span class="token punctuation">(</span><span class="token string">&quot;Insert&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setCta</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onSubmit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>linkText<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>linkUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="试作插件-切换复选框状态" tabindex="-1"><a class="header-anchor" href="#试作插件-切换复选框状态"><span>试作插件 - 切换复选框状态</span></a></h3><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Editor<span class="token punctuation">,</span> MarkdownView<span class="token punctuation">,</span> Modal<span class="token punctuation">,</span> Notice<span class="token punctuation">,</span> Plugin<span class="token punctuation">,</span> PluginSettingTab<span class="token punctuation">,</span> Setting <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;obsidian&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> test <span class="token keyword">from</span> <span class="token string">&#39;node:test&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 记得重命名这些类和接口!</span>

<span class="token keyword">interface</span> <span class="token class-name">MyPluginSettings</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token operator">:</span> MyPluginSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token string">&#39;default&#39;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 1. Plugin接口的实现
 *
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
	settings<span class="token operator">:</span> MyPluginSettings<span class="token punctuation">;</span>

	<span class="token comment">// 插件加载后</span>
	<span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">/* 1. 左侧工具栏相关的操作 */</span>
		<span class="token comment">/* 在左侧色带中创建一个图标
		 *     参数1：估计是图标名
		 *     参数2：悬浮提示名
		 *     参数3：事件
		 */</span>
		<span class="token keyword">const</span> ribbonIconEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&#39;dice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Sample Plugin&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// 当用户单击图标时调用：发送一条信息</span>
			<span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token string">&#39;This is a notice!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 对色带执行额外的操作</span>
		ribbonIconEl<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;my-plugin-ribbon-class&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


		<span class="token comment">/* 2. 右下角的状态栏增添一段文字
		 * 移动应用程序中不工作
		 */</span>
		<span class="token keyword">const</span> statusBarItemEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addStatusBarItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		statusBarItemEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Status Bar Text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


		<span class="token comment">/* 3. 下面增加三个可以在任何地方触发的简单命令
		 * addCommand函数
		 *     参数1：id
		 *     参数2：命令名字
		 *     参数3：事件，一个回调函数
		 */</span>

		<span class="token comment">// 3.1. 打开一个窗口</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-simple&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (simple)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.2. 这将添加一个编辑器命令，可以对当前编辑器实例执行某些操作。这里是在光标所在位置打印一串字符串</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;sample-editor-command&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Sample editor command&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				editor<span class="token punctuation">.</span><span class="token function">replaceSelection</span><span class="token punctuation">(</span><span class="token string">&#39;Sample Editor Command&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.3. 这添加了一个复杂的命令,可以检查应用程序的当前状态是否允许执行命令</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-complex&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (complex)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">checkCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>checking<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token comment">// 条件检查</span>
				<span class="token keyword">const</span> markdownView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>markdownView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 如果检查为真，我们只是在“检查”命令是否可以运行</span>
					<span class="token comment">// 如果检查为false，那么我们想实际执行操作</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>checking<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token comment">// 只有当check函数返回true时，该命令才会显示在命令面板中</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 一些实验：</span>
		<span class="token comment">// editor.getValue() // 获取全部内容</span>
		<span class="token comment">// editor.lineCount() // 一共有多少行</span>
		<span class="token comment">// let i = editor.getCursor().line // 光标在第几行</span>
		<span class="token comment">// editor.replaceSelection(&#39;SSS：&#39;+s1+&quot;DDD&quot;) // 光标后输出</span>

		<span class="token comment">// &quot;- [ ] 678&quot;.match(new RegExp(\`^(\\s*- )(\\\\[[* +-x]\\\\])(.*)\`))</span>
		<span class="token comment">// Array(4) [ &quot;- [ ] 678&quot;, &quot;- &quot;, &quot;[ ]&quot;, &quot; 678&quot; ]</span>
		<span class="token comment">// editor.replaceSelection(&#39;   SSS:【&#39;+ s1.match(r1)+&quot;】【&quot; +s1.match(r2)+&quot;】【&quot;+ s1+&quot;】&quot;)</span>

		<span class="token comment">// 4. 切换鼠标所在行的复选框状态</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;test&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;切换鼠标所在行的复选框状态&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				

				<span class="token keyword">let</span> s1 <span class="token operator">:</span><span class="token builtin">string</span> <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getLine</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>line<span class="token punctuation">)</span> <span class="token comment">// 获取序列行的内容</span>
				
				<span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">^\\\\s*- \\\\[[( )]\\\\](.*)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
				<span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">^\\\\s*- \\\\[[(*+-x)]\\\\](.*)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					s1 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;[ ]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;[*]&quot;</span><span class="token punctuation">)</span>	<span class="token comment">// 这里写得比较简陋，会有bug，比如- [ ] [ ]</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					s1 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;[*]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;[ ]&quot;</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>

				editor<span class="token punctuation">.</span><span class="token function">setLine</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>line<span class="token punctuation">,</span> s1<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将添加一个设置选项卡，以便用户可以配置插件的各个方面</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addSettingTab</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SampleSettingTab</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 如果该插件连接了任何全局DOM事件(在不属于该插件的应用程序部分上)</span>
		<span class="token comment">//当这个插件被禁用时，使用这个函数会自动删除事件监听器。</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerDomEvent</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 当注册间隔时，当插件被禁用时，该函数将自动清除间隔</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerInterval</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;setInterval&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 插件停用后</span>
	<span class="token function">onunload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token comment">// 插件设置加载后</span>
	<span class="token keyword">async</span> <span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>settings <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token punctuation">,</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 插件设置保存后</span>
	<span class="token keyword">async</span> <span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 2. Modal接口的实现
 * 打开的提示窗口的实体
 */</span>
<span class="token keyword">class</span> <span class="token class-name">SampleModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Woah!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 3. PluginSettingTab接口的实现
 * 这个是设置菜单里的设置
 */</span>
<span class="token keyword">class</span> <span class="token class-name">SampleSettingTab</span> <span class="token keyword">extends</span> <span class="token class-name">PluginSettingTab</span> <span class="token punctuation">{</span>
	plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">,</span> plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>plugin <span class="token operator">=</span> plugin<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>containerEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

		containerEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 一个h2标题</span>
		containerEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&#39;h2&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>text<span class="token operator">:</span> <span class="token string">&#39;Settings for my awesome plugin.&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 创建一个新的设置项</span>
		<span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>containerEl<span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&#39;Setting #1&#39;</span><span class="token punctuation">)</span>											<span class="token comment">// 设置项名字</span>
			<span class="token punctuation">.</span><span class="token function">setDesc</span><span class="token punctuation">(</span><span class="token string">&#39;It\\&#39;s a secret&#39;</span><span class="token punctuation">)</span>									<span class="token comment">// 设置项提示</span>
			<span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span>text <span class="token operator">=&gt;</span> text												<span class="token comment">// 输入框</span>
				<span class="token punctuation">.</span><span class="token function">setPlaceholder</span><span class="token punctuation">(</span><span class="token string">&#39;Enter your secret&#39;</span><span class="token punctuation">)</span>			<span class="token comment">// 没有内容时的提示</span>
				<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Secret: &#39;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting <span class="token operator">=</span> value<span class="token punctuation">;</span>
					<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span><span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="后处理器" tabindex="-1"><a class="header-anchor" href="#后处理器"><span>后处理器</span></a></h3><p>https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/markdown-post-processing.html</p><p>使用：例如：（预览模式下生效）</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>\`:+1:\`
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="其他-1" tabindex="-1"><a class="header-anchor" href="#其他-1"><span>其他</span></a></h2><p>直接让Obsidian界面半崩溃</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// app = new App()</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="vault" tabindex="-1"><a class="header-anchor" href="#vault"><span>Vault</span></a></h2><p>js文件都是在一个虚拟路径上运行的：</p><p>C:\\Users\\A\\AppData\\Local\\Obsidian\\resources\\electron.asar</p><p>英文状态下，打开其他库叫 “Open another vault” 打开其他库的菜单中，显示的是：Create new vault、OPen folder as vault、Open vault form Obsidian Sync</p><p>控制台可以直接打印：（比较方便）</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>__filename
this
this.app 或 app
this.app.vault 	<span class="token comment"># .adapter.basePath就是库的路径了（包括库名）</span>
				<span class="token comment"># .configDir</span>
				<span class="token comment"># .getName()，当前库的名字</span>
				<span class="token comment"># _.sourcePath</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="view-editor" tabindex="-1"><a class="header-anchor" href="#view-editor"><span>view / editor</span></a></h2><p>好多叫view/editor的，他们的类型都不同</p><p><strong>我个人认为将诸如MarkdownView、EditorView、View的变量都叫成view，是非常不妥的</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 受参类</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor<span class="token punctuation">,</span> 							<span class="token comment">// Editor</span>
        <span class="token literal-property property">view</span><span class="token operator">:</span> MarkdownView							<span class="token comment">// MarkdownView</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// @ts-expect-error, not typed</span>
    <span class="token keyword">const</span> editorView <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>cm <span class="token keyword">as</span> EditorView<span class="token punctuation">;</span><span class="token comment">// EditorView from &quot;@codemirror/view&quot;</span>
    <span class="token keyword">const</span> plugin <span class="token operator">=</span> editorView<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span>examplePlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token comment">// 受参类</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AnyBlockPluginValue</span> <span class="token keyword">implements</span> <span class="token class-name">PluginValue</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">decorations</span><span class="token operator">:</span> DecorationSet<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">view</span><span class="token operator">:</span> EditorView</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> view <span class="token punctuation">}</span>			<span class="token comment">// EditorView from &quot;@codemirror/view&quot;</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">update</span><span class="token operator">:</span> ViewUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> update<span class="token punctuation">.</span>view <span class="token punctuation">}</span> 		<span class="token comment">// 这个view和上面那个是一样的</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token literal-property property">view</span><span class="token operator">:</span> View<span class="token operator">|</span><span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//  // 未聚焦(active)会返回null</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>view<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span> 							<span class="token comment">// 不在编辑模式好像**不**会返回null</span>
<span class="token comment">// @ts-ignore 这里会说View没有editor属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token comment">// @ts-ignore 这里会说Editor没有cm属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorView</span><span class="token operator">:</span> EditorView <span class="token operator">=</span> editor<span class="token punctuation">.</span>cm
<span class="token comment">// @ts-ignore 这里会说Editor没有containerEl属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorElement</span><span class="token operator">:</span> Element <span class="token operator">=</span> editVar<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>containerEl
<span class="token keyword">const</span> <span class="token literal-property property">editorState</span><span class="token operator">:</span> EditorState <span class="token operator">=</span> editorView<span class="token punctuation">.</span>state
<span class="token comment">// const state: any = view.getState() 这个不是</span>
<span class="token keyword">const</span> <span class="token literal-property property">cursor</span><span class="token operator">:</span> EditorPosition <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">const</span> view <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>	
<span class="token keyword">this</span>
plugin_this
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>view<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token keyword">const</span> editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token keyword">const</span> cursor <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>									<span class="token comment">// </span>
<span class="token keyword">const</span> state <span class="token operator">=</span> view<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> editorView <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>cm <span class="token keyword">as</span> EditorView

<span class="token comment">// 转化类</span>
EditorView<span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>									<span class="token comment">// EditorState from &quot;@codemirror/state&quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>补充：ts报错说找不到属性的问题</p><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// @ts-ignore 这里会说View没有editor属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token comment">// @ts-ignore 这里会说Editor没有cm属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorView</span><span class="token operator">:</span> EditorView <span class="token operator">=</span> editor<span class="token punctuation">.</span>cm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>this.app.workspace.getActiveViewOfType(MarkdownView);</code>中，this和plugin_this都可以 他们的.app出来的内容是一样，区别在于类型声明不同。 所以看起来用plugin_this会报错而this不会，但其实本质是一样的，报错的话加个@ts-ignore就行了。</p><p>View类型看原型没有，但打印出来它确实是有editor参数的 Ediot类型看原型没有，但打印出来它确实是有cm参数的</p></blockquote><p>类型验证</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token literal-property property">view</span><span class="token operator">:</span> View<span class="token operator">|</span><span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>view<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token comment">// @ts-ignore 这里会说View没有editor属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token comment">// @ts-ignore 这里会说Editor没有cm属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorView</span><span class="token operator">:</span> EditorView <span class="token operator">=</span> editor<span class="token punctuation">.</span>cm
<span class="token keyword">const</span> <span class="token literal-property property">editorState</span><span class="token operator">:</span> EditorState <span class="token operator">=</span> editorView<span class="token punctuation">.</span>state
<span class="token comment">// const state: any = view.getState() // 这个不是</span>
<span class="token keyword">const</span> <span class="token literal-property property">cursor</span><span class="token operator">:</span> EditorPosition <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// console.log(&quot;【Msg】 this&quot;, this.constructor.name, this instanceof Window, typeof(this), this)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 cursor&quot;</span><span class="token punctuation">,</span> cursor<span class="token punctuation">.</span>discriminator <span class="token operator">===</span> <span class="token string">&quot;EditorPosition&quot;</span><span class="token punctuation">,</span> cursor<span class="token punctuation">)</span> 			<span class="token comment">// False Object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 view&quot;</span><span class="token punctuation">,</span> view <span class="token keyword">instanceof</span> <span class="token class-name">View</span><span class="token punctuation">,</span> view<span class="token punctuation">)</span>								<span class="token comment">// from &#39;obsidian&#39;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 editor&quot;</span><span class="token punctuation">,</span> editor <span class="token keyword">instanceof</span> <span class="token class-name">Editor</span><span class="token punctuation">,</span> editor<span class="token punctuation">)</span>						<span class="token comment">// from &#39;obsidian&#39;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 editorState&quot;</span><span class="token punctuation">,</span> editorState <span class="token keyword">instanceof</span> <span class="token class-name">EditorState</span><span class="token punctuation">,</span> editorState<span class="token punctuation">)</span>	<span class="token comment">// from &#39;@codemirror/state&#39;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 editorView&quot;</span><span class="token punctuation">,</span> editorView <span class="token keyword">instanceof</span> <span class="token class-name">EditorView</span><span class="token punctuation">,</span> editorView<span class="token punctuation">)</span>		<span class="token comment">// from &quot;@codemirror/view&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 state&quot;</span><span class="token punctuation">,</span> state <span class="token keyword">instanceof</span> <span class="token class-name">EditorState</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span> 						<span class="token comment">// False Object any</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 this&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Window</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 plugin_this&quot;</span><span class="token punctuation">,</span> plugin_this <span class="token keyword">instanceof</span> <span class="token class-name">AnyBlockPlugin</span><span class="token punctuation">,</span> plugin_this<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,54)]))}const l=s(e,[["render",o],["__file","06. 其他.html.vue"]]),u=JSON.parse('{"path":"/01.%20DesignAndDevelop/Develop/04.%20Project/Type/Doc/MarkdwonAbout/01.%20Soft%20And%20Frame/Obsidian/%E3%80%8AObsidian%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3%E3%80%8B/06.%20%E5%85%B6%E4%BB%96.html","title":"其他","lang":"zh-CN","frontmatter":{"description":"其他 官方示例 Obsidian-sample-plugin https://github.com/obsidianmd/obsidian-sample-plugin 使用 编译方法 手动安装插件 复制 main.js, styles.css, manifest. js 到Ob的插件路径 功能 有设置菜单 有小图标，小图标可以输出tips 输出文字 “...","head":[["meta",{"property":"og:url","content":"https://LincDocs.github.io/MdNote_Public/01.%20DesignAndDevelop/Develop/04.%20Project/Type/Doc/MarkdwonAbout/01.%20Soft%20And%20Frame/Obsidian/%E3%80%8AObsidian%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3%E3%80%8B/06.%20%E5%85%B6%E4%BB%96.html"}],["meta",{"property":"og:site_name","content":"MdNote_Public"}],["meta",{"property":"og:title","content":"其他"}],["meta",{"property":"og:description","content":"其他 官方示例 Obsidian-sample-plugin https://github.com/obsidianmd/obsidian-sample-plugin 使用 编译方法 手动安装插件 复制 main.js, styles.css, manifest. js 到Ob的插件路径 功能 有设置菜单 有小图标，小图标可以输出tips 输出文字 “..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-19T07:08:37.000Z"}],["meta",{"property":"article:author","content":"LincDocs"}],["meta",{"property":"article:modified_time","content":"2025-01-19T07:08:37.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"其他\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-19T07:08:37.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincDocs\\",\\"url\\":\\"https://github.com/LincDocs/MdNote_Public/\\"}]}"]]},"headers":[{"level":1,"title":"其他","slug":"其他","link":"#其他","children":[{"level":2,"title":"官方示例","slug":"官方示例","link":"#官方示例","children":[{"level":3,"title":"Obsidian-sample-plugin","slug":"obsidian-sample-plugin","link":"#obsidian-sample-plugin","children":[{"level":4,"title":"使用","slug":"使用","link":"#使用","children":[]},{"level":4,"title":"代码","slug":"代码","link":"#代码","children":[]}]},{"level":3,"title":"API接口","slug":"api接口","link":"#api接口","children":[]},{"level":3,"title":"插入链接示例（开发文档示例）","slug":"插入链接示例-开发文档示例","link":"#插入链接示例-开发文档示例","children":[]},{"level":3,"title":"试作插件 - 切换复选框状态","slug":"试作插件-切换复选框状态","link":"#试作插件-切换复选框状态","children":[]},{"level":3,"title":"后处理器","slug":"后处理器","link":"#后处理器","children":[]}]},{"level":2,"title":"其他","slug":"其他-1","link":"#其他-1","children":[]},{"level":2,"title":"Vault","slug":"vault","link":"#vault","children":[]},{"level":2,"title":"view / editor","slug":"view-editor","link":"#view-editor","children":[]}]}],"git":{"createdTime":1737270517000,"updatedTime":1737270517000,"contributors":[{"name":"Linc","email":"762699299@qq.com","commits":1}]},"readingTime":{"minutes":9.05,"words":2716},"filePathRelative":"01. DesignAndDevelop/Develop/04. Project/Type/Doc/MarkdwonAbout/01. Soft And Frame/Obsidian/《Obsidian 插件开发文档》/06. 其他.md","localizedDate":"2025年1月19日","excerpt":"\\n<h2>官方示例</h2>\\n<h3>Obsidian-sample-plugin</h3>\\n<p>https://github.com/obsidianmd/obsidian-sample-plugin</p>\\n<h4>使用</h4>\\n<blockquote>\\n<h5>编译方法</h5>\\n</blockquote>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token comment\\"># 首先要先安装nodejs，里面包含npm工具</span>\\n<span class=\\"token function\\">npm</span> i             <span class=\\"token comment\\"># 等同于npm install</span>\\n<span class=\\"token function\\">npm</span> run dev       <span class=\\"token comment\\"># 进行编译，将ts编译成js</span>\\n\\n<span class=\\"token comment\\"># 如果Obsidian API更新了</span>\\n<span class=\\"token function\\">npm</span> update\\n</code></pre></div>","autoDesc":true,"bioChainData":{"outlink":[],"backlink":[],"localMap":{"nodes":[{"id":"01. DesignAndDevelop/Develop/04. Project/Type/Doc/MarkdwonAbout/01. Soft And Frame/Obsidian/《Obsidian 插件开发文档》/06. 其他.md","value":{"title":"06. 其他","path":"01. DesignAndDevelop/Develop/04. Project/Type/Doc/MarkdwonAbout/01. Soft And Frame/Obsidian/《Obsidian 插件开发文档》/06. 其他.md","outlink":[],"backlink":[]}}],"links":[]}}}');export{l as comp,u as data};
